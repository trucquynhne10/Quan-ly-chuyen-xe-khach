create database quanlybenxenewNew;
use quanlybenxenew;
SET NAMES utf8mb4;

-- drop database quanlybenxenewnew

CREATE TABLE KHACHHANG (
  MAKH CHAR(8) PRIMARY KEY,
  TENKH VARCHAR(30) NOT NULL,
  DCHI VARCHAR(50) NOT NULL,
  DTHOAI CHAR(11) NOT NULL
) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;



CREATE TABLE HANGXE (
    MAHANG Char(8) PRIMARY KEY,
    TENHANG varchar(30) NOT NULL COLLATE utf8mb4_unicode_ci
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE BENXE (
MABEN varchar(10) PRIMARY KEY ,
TENBEN varchar(30) NOT NULL COLLATE utf8mb4_unicode_ci,
DIACHI varchar(200) NOT NULL COLLATE utf8mb4_unicode_ci
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE BANGLAI (
  HANGBL CHAR(3) PRIMARY KEY,
  SOGHE_QD INT NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE LOAIXE (
MALOAI CHAR(8) PRIMARY KEY NOT NULL,
TENLOAI VARCHAR(30) NOT NULL COLLATE utf8mb4_unicode_ci,
SOGHE INT,
HANGBL CHAR(3),
CONSTRAINT FK_LOAIXE_BANGLAI FOREIGN KEY (HANGBL) REFERENCES BANGLAI(HANGBL) ON DELETE SET NULL ON UPDATE CASCADE
)DEFAULT CHARSET=utf8mb4, ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE NHANVIEN (
  MANV CHAR(8) PRIMARY KEY,
  TENNV VARCHAR(30) NOT NULL COLLATE utf8mb4_unicode_ci,
  DCHI VARCHAR(50) NOT NULL,
  DTHOAI CHAR(11) NOT NULL,
  LUONG FLOAT NOT NULL,
  LOAINV INT NOT NULL CHECK (LOAINV IN (0,1,2)),
  GIOITINH CHAR(3),
  NGAYVL DATE,
  HANGBL CHAR(3) null references BANGLAI(HANGBL),
  MAHANG CHAR(8) references HANGXE(MAHANG),
 CONSTRAINT FK_NV_BANGLAI FOREIGN KEY (HANGBL) REFERENCES BANGLAI(HANGBL)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE XE (
  BIENSO VARCHAR(20) PRIMARY KEY NOT NULL,
  MAHANG CHAR(8) NOT NULL,
  MALOAI CHAR(8) NOT NULL,
  CONSTRAINT FK_XE_HANGXE FOREIGN KEY (MAHANG) REFERENCES HANGXE(MAHANG),
  CONSTRAINT FK_XE_LOAIXE FOREIGN KEY (MALOAI) REFERENCES LOAIXE(MALOAI)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE TUYENXE (
  MATUYEN VARCHAR(10) NOT NULL,
  BENXEDI VARCHAR(10) NOT NULL,
  BENXEDEN VARCHAR(10) NOT NULL,
  PRIMARY KEY (MATUYEN),
  FOREIGN KEY (BENXEDI) REFERENCES BENXE(MABEN),
  FOREIGN KEY (BENXEDEN) REFERENCES BENXE(MABEN)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE CHUYENXE (
MACX CHAR(8) PRIMARY KEY NOT NULL,
NGAYDI DATE,
GIODI TIME,
BIENSO VARCHAR(20) NOT NULL COLLATE utf8mb4_unicode_ci,
MATUYEN VARCHAR(10),
GIA INT,
CONSTRAINT FK_CHUYENXE_XE FOREIGN KEY (BIENSO) REFERENCES XE(BIENSO),
CONSTRAINT FK_CX_MT FOREIGN KEY (MATUYEN) REFERENCES TUYENXE(MATUYEN)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE HOADON (
  SOHD CHAR(5) PRIMARY KEY,
  MAKH CHAR(8) NOT NULL,
  NGAYDAT DATE default null,
  HT_THANHTOAN VARCHAR(20) NOT NULL COLLATE utf8mb4_unicode_ci,
  THANHTIEN INT default NULL,
  MANV CHAR(8) NOT NULL,
  CONSTRAINT FK_HOADON_KHACHHANG FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH),
  CONSTRAINT FK_HOADON_NHANVIEN FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE VE (
    MAVE CHAR(8) PRIMARY KEY NOT NULL,
    SOHD CHAR(5) NOT NULL,
    MACX CHAR(8) NOT NULL,
    GIA INT,
    VITRI INT,
    CONSTRAINT FK_VE_CHUYENXE FOREIGN KEY (MACX) REFERENCES CHUYENXE(MACX),
	CONSTRAINT FK_VE_HOADON FOREIGN KEY (SOHD) REFERENCES HOADON(SOHD)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE PHANCONG (
  MANV CHAR(8),
  MACX CHAR(8),
  CONSTRAINT FK_PHANCONG_NHANVIEN FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
  CONSTRAINT FK_PHANCONG_CHUYENXE FOREIGN KEY (MACX) REFERENCES CHUYENXE(MACX),
  PRIMARY KEY (MANV, MACX)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-- ---------------------------------------------------------------------------------------
-- Trigger 1: Giá vé được lấy từ vé của chuyến xe
DELIMITER //
CREATE TRIGGER INSERT_GIA_VE
BEFORE INSERT ON VE
FOR EACH ROW
BEGIN
  -- Cập nhật trường GIA trong bảng VE
  IF NEW.SOHD IN (SELECT SOHD FROM HOADON) THEN
    SET NEW.GIA = (
      SELECT Gia FROM CHUYENXE
      WHERE CHUYENXE.MACX = NEW.MACX 
    );
  END IF;
END//
DELIMITER ;
SELECT * FROM VE;

DELIMITER //
CREATE TRIGGER update_GIA_VE
BEFORE UPDATE ON VE
FOR EACH ROW
BEGIN
  -- Cập nhật trường GIA trong bảng VE
  IF NEW.SOHD IN (SELECT SOHD FROM HOADON) THEN
    SET NEW.GIA = (
      SELECT Gia FROM CHUYENXE
      WHERE CHUYENXE.MACX = NEW.MACX 
    );
  END IF;
END//
DELIMITER ;

SELECT * FROM VE;

-- ------------------------------------------------------------------
-- trigger 2
-- CAU LENH INSERT VE
DELIMITER //
CREATE TRIGGER INSERT_THANHTIEN_HOADON
AFTER INSERT ON VE
FOR EACH ROW
BEGIN
  DECLARE TONG FLOAT;
  declare MAV CHAR(8) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  SET MAV = NEW.MAVE;
    -- Tính tổng tiền
  SET TONG =  new.gia;
    -- Cập nhật tổng tiền vào bảng HOADON
  UPDATE HOADON SET THANHTIEN =  THANHTIEN + TONG 
  WHERE HOADON.SOHD = NEW.SOHD;
END//
DELIMITER ;


-- CAU LENH DELETE VE
DELIMITER //
CREATE TRIGGER DELETE_THANHTIEN_HOADON
AFTER DELETE ON ve
FOR EACH ROW
BEGIN
  DECLARE TONG FLOAT;
  declare MAV CHAR(8) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  
  -- Tính tổng tiền
  SET TONG =  old.gia;
  
  -- Cập nhật tổng tiền vào bảng DONBANHANG
  UPDATE HOADON SET THANHTIEN =  THANHTIEN - TONG 
  WHERE HOADON.SOHD = OLD.SOHD;
END//
DELIMITER ;
-- ------------------------------------------------------------------------------------------
-- trigger 3:
DELIMITER //
CREATE TRIGGER check_license_type
BEFORE INSERT ON NHANVIEN
FOR EACH ROW
BEGIN
    IF NEW.LOAINV = 1 AND NEW.HANGBL IS NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Tài xế phải có cấp bằng lái';
    END IF;
    IF NEW.LOAINV = 2 AND NEW.HANGBL IS NOT NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Phụ xe không cần yêu cầu bằng lái - vui lòng để null';
    END IF;
    IF NEW.LOAINV = 0 AND NEW.HANGBL IS NOT NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Nhân viên bán vé không cần yêu cầu bằng lái - vui lòng để null';
    END IF;
END //
DELIMITER ;

DELIMITER //
CREATE TRIGGER check_license_type_upd
BEFORE UPDATE ON NHANVIEN
FOR EACH ROW
BEGIN
    IF NEW.LOAINV = 1 AND NEW.HANGBL IS NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Tài xế phải có cấp bằng lái';
    END IF;
    IF NEW.LOAINV = 2 AND NEW.HANGBL IS NOT NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Phụ xe không cần yêu cầu bằng lái - vui lòng để null';
    END IF;
    IF NEW.LOAINV = 0 AND NEW.HANGBL IS NOT NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Nhân viên bán vé không cần yêu cầu bằng lái - vui lòng để null';
    END IF;
END //
DELIMITER ;
-- ----------------------------------------------------------------------------
-- trigger 4
-- Cau lenh insert PHANCONG
DELIMITER //
CREATE TRIGGER INSERT_PHANCONG
before INSERT ON PHANCONG
FOR EACH ROW
BEGIN
  DECLARE HBL CHAR(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  DECLARE NVHBL CHAR(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  DECLARE loai int;
  
  select LOAINV into loai from NHANVIEN where NHANVIEN.MANV = NEW.MANV;
  SELECT HANGBL into HBL FROM CHUYENXE CX, XE, LOAIXE LX WHERE NEW.MACX = CX.MACX AND CX.BIENSO=XE.BIENSO AND XE.MALOAI = LX.MALOAI;
  SELECT HANGBL INTO NVHBL FROM NHANVIEN WHERE NEW.MANV=NHANVIEN.MANV;
  IF loai = 1 THEN
	IF NVHBL < HBL THEN
		SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Tai xe khong the lai xe duoc phan cong do HANGBL khong dat yeu cau';
	end if;
ELSEIF loai = 0 then
	SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Day khong phai la nhan vien lai xe hay phu lai';
END IF;
END//
DELIMITER ;
-- cau lenh update NHANVIEN
DELIMITER //
CREATE TRIGGER UPDATE_PHANCONG_NV
before UPDATE ON NHANVIEN
FOR EACH ROW
BEGIN
  if new.manv in (select manv from phancong) and new.loainv =1 then
	IF new.hangbl < old.hangbl THEN
		SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Khong the update hangbl nho hon vi nhan vien nay da duoc phan cong';
	end if;
END IF;
END//
DELIMITER ;
-- ------------------------------------------------------------------------------------------
-- trigger 5:
DELIMITER //
CREATE TRIGGER trg_check_VE_ngaydat
BEFORE INSERT ON VE
FOR EACH ROW
BEGIN
    IF EXISTS (
        SELECT 1
        FROM CHUYENXE
        INNER JOIN HOADON ON CHUYENXE.MACX = NEW.MACX AND HOADON.SOHD = NEW.SOHD
        WHERE HOADON.NGAYDAT > CHUYENXE.NGAYDI
    ) THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Ngày đặt vé phải trước lịch trình xe chạy.';
    END IF;
END//
DELIMITER ;

-- update CHUYENXE
DELIMITER //
CREATE TRIGGER trg_update_chuyenxe_ngaydi
BEFORE UPDATE ON CHUYENXE
FOR EACH ROW
BEGIN
    DECLARE ND DATE;
    SET ND = NEW.NGAYDI;
    IF EXISTS (
        SELECT 1
        FROM HOADON, VE
        WHERE NEW.MACX = VE.MACX
        AND HOADON.SOHD = ve.SOHD
        AND HOADON.NGAYDAT > ND
    ) THEN
        SIGNAL SQLSTATE '45000'
            SET MESSAGE_TEXT = 'Ngay di phai sau ngay dat ve.';
    END IF;
END//
DELIMITER ;
-- ------------------------------------------------------------------------------------------
-- trigger 6: kiểm tra vị trí ghế đã tồn tại chưa
DELIMITER //
CREATE TRIGGER INSERT_VITRI 
BEFORE INSERT ON VE
FOR EACH ROW
BEGIN
	IF EXISTS (SELECT 1 FROM VE WHERE VITRI = NEW.VITRI) THEN
    	SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Số ghế của chuyến xe này đã tồn tại.';
    END IF;
END//
DELIMITER ;

DELIMITER //
CREATE TRIGGER INSERT_VITRI 
BEFORE UPDATE ON VE
FOR EACH ROW
BEGIN
	IF EXISTS (SELECT 1 FROM VE WHERE VITRI = NEW.VITRI) THEN
    	SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Số ghế của chuyến xe này đã tồn tại.';
    END IF;
END//
DELIMITER ;
-- ---------------------------------------------------------------------------------------------------------
INSERT INTO KHACHHANG (MAKH, TENKH, DCHI, DTHOAI) VALUES 
('KH000001', 'Nguyễn Văn Hòa', 'Hồ Chí Minh', '09834567891'),
('KH000002', 'Trần Thị Ngọc Minh', 'Bình Dương', '01255678912'),
('KH000003', 'Lê Văn Tân', 'Tây Ninh', '03771234563'),
('KH000004', 'Hoàng Thị Thanh Hương', 'Bến Tre', '04623698544'),
('KH000005', 'Phạm Văn Đức', 'Tiền Giang', '03823456785'),
('KH000006', 'Nguyễn Thị Tuyết Nhung', 'Hồ Chí Minh', '09182345676'),
('KH000007', 'Đặng Văn Nam', 'Cần Thơ', '09871234567'),
('KH000008', 'Trần Thị Quỳnh Anh', 'Vũng Tàu', '01252345674'),
('KH000009', 'Lê Văn Bình', 'Hồ Chí Minh', '03778787872'),
('KH000010', 'Hoàng Thị Thu Trang', 'Long An', '03824567891'),
('KH000011', 'Phạm Văn Tài', 'Hồ Chí Minh', '09894561239'),
('KH000012', 'Lê Thị Tâm', 'Cà Mau', '03771234675'),
('KH000013', 'Trần Văn Thành', 'Hồ Chí Minh', '09183456234'),
('KH000014', 'Lương Thị Bích Ngọc', 'Đồng Nai', '04622222228'),
('KH000015', 'Phan Văn Cường', 'Hồ Chí Minh', '09189990001'),
('KH000016', 'Nguyễn Thị Thanh Tâm', 'Bình Dương', '01256666774'),
('KH000017', 'Vũ Văn Huy', 'Hồ Chí Minh', '03820000006'),
('KH000018', 'Lê Thị Minh Trang', 'Tây Ninh', '09181234565'),
('KH000019', 'Phạm Văn Anh', 'Hồ Chí Minh', '03772345671'),
('KH000020', 'Nguyễn Thị Mai', 'Bình Phước', '09836789018');

INSERT INTO BANGLAI (HANGBL, SOGHE_QD) VALUES 
('B2', 9),
('C', 9),
('D', 30),
('E', 45);

INSERT INTO HANGXE (MAHANG, TENHANG) VALUES
('HX00001', 'Phuong Trang'),
('HX00002', 'Mai Linh'),
('HX00003', 'Hung Cuong'),
('HX00004', 'Hoang Long'),
('HX00005', 'Thanh Buoi');

INSERT INTO NHANVIEN (MANV, TENNV, DCHI, DTHOAI, LUONG, LOAINV, NGAYVL, HANGBL, MAHANG, GIOITINH)
VALUES
('NV00001', 'Bạch Văn Hùng', 'Nghệ An', '0125317321', 14000000, 1, '2022-01-05', 'C', 'HX00003', 'Nam'),
('NV00002', 'Hoàng Thị Thuý', 'Hồ Chí Minh', '0918145982', 17000000, 1, '2022-02-17', 'D', 'HX00002', 'Nữ'),
('NV00003', 'Nguyễn Minh Tuấn', 'Đà Nẵng', '0462337192', 9500000, 0, '2022-03-21', NULL, 'HX00001', 'Nam'),
('NV00004', 'Phan Thị Lan Anh', 'Thanh Hóa', '0983845671', 8000000, 0, '2022-04-12', NULL, 'HX00001', 'Nữ'),
('NV00005', 'Đặng Minh Trí', 'Sóc Trăng', '0382559048', 6500000, 2, '2022-05-29', NULL, 'HX00003', 'Nam'),
('NV00006', 'Phạm Văn Thiên', 'Bình Dương', '0377111222', 9000000, 0, '2022-06-08', NULL, 'HX00002', 'Nam'),
('NV00007', 'Trần Văn Thắng', 'Hồ Chí Minh', '0918587092', 15000000, 1, '2022-07-14', 'C', 'HX00004', 'Nam'),
('NV00008', 'Đinh Thị Minh Hạnh', 'Hà Nội', '0918567843', 8000000, 2, '2022-08-02', NULL, 'HX00001', 'Nữ'),
('NV00009', 'Nguyễn Văn Tú', 'Quảng Nam', '0462846738', 13000000, 1, '2022-09-18', 'D', 'HX00001', 'Nam'),
('NV00010', 'Trần Thị Thu Hà', 'Tiền Giang', '0125579023', 8000000, 0, '2022-10-30', NULL, 'HX00003', 'Nữ'),
('NV00011', 'Võ Minh Nhật', 'Bình Thuận', '0382449315', 7500000, 2, '2022-11-05', NULL, 'HX00001', 'Nam'),
('NV00012', 'Nguyễn Thị Trang', 'Đồng Nai', '0377478324', 9500000, 0, '2022-12-25', NULL, 'HX00003', 'Nữ'),
('NV00013', 'Lê Thị Thanh Huyền', 'Hồ Chí Minh', '0918789234', 8000000, 2, '2022-02-02', NULL, 'HX00001', 'Nữ'),
('NV00014', 'Trương Hữu Nam', 'Hà Nội', '0125489132', 16000000, 1, '2022-03-12', 'E', 'HX00001', 'Nam'),
('NV00015', 'Nguyễn Thị Tuyết Mai', 'Hồ Chí Minh', '0918273465', 8500000, 0, '2022-04-24', NULL, 'HX00004', 'Nữ'),
('NV00016', 'Trần Đức Chính', 'Lâm Đồng', '0918557890', 13000000, 1, '2022-05-15', 'E', 'HX00001', 'Nam'),
('NV00017', 'Trương Đức Hiếu', 'Bắc Ninh', '0983773281', 8000000, 0, '2022-06-28', NULL, 'HX00005', 'Nam'),
('NV00018', 'Phan Thành Vinh', 'Đồng Nai', '0752624713', 9000000, 0, '2022-07-20', NULL, 'HX00005', 'Nam'),
('NV00019', 'Hoàng Linh', 'Khánh Hòa', '0918465279', 19000000, 1, '2022-08-10', 'E', 'HX00005', 'Nữ'),
('NV00020', 'Đỗ Mạnh Tuấn', 'Kiên Giang', '0167377021', 11000000, 2, '2022-09-05', NULL, 'HX00005', 'Nam'),
('NV00021', 'Nguyễn Hà Nhi', 'Cần Thơ', '0123456789', 10000000, 1, '2022-10-19', 'D', 'HX00004', 'Nữ'),
('NV00022', 'Lê Tuyết', 'Vũng Tàu', '0987654321', 9000000, 2, '2022-11-28', NULL, 'HX00004', 'Nam'),
('NV00023', 'Trần Văn An', 'Đà Lạt', '0369876543', 8500000, 1, '2022-12-17', 'E', 'HX00002', 'Nam'),
('NV00024', 'Phạm Thị Nhung', 'Tây Ninh', '0543216789', 12000000, 2, '2022-01-08', NULL, 'HX00003', 'Nữ'),
('NV00025', 'Nguyễn Mộng Hoàng', 'Gia Lai', '0712345678', 11000000, 1, '2022-02-14', 'E', 'HX00002', 'Nam'),
('NV00026', 'Đinh Hùng', 'Bắc Giang', '0742345679', 13000000, 1, '2022-03-26', 'D', 'HX00003', 'Nam'),
('NV00027', 'Hoàng Hiếu', 'Vĩnh Long', '0384728482', 12800000, 1, '2022-04-09', 'E', 'HX00003', 'Nam'),
('NV00028', 'Nguyễn Minh Tài', 'An Giang', '0234528482', 9800000, 2, '2022-05-23', NULL, 'HX00003', 'Nam'),
('NV00029', 'Hà Minh Tuấn', 'Hậu Giang', '0384571135', 8900000, 2, '2022-06-18', NULL, 'HX00002', 'Nam'),
('NV00030', 'Nguyễn Thị Hương', 'Hà Nội', '0987654321', 9000000, 1, '2022-07-05', 'D', 'HX00005', 'Nữ'),
('NV00031', 'Trần Thị Mai', 'Thanh Hóa', '0901234567', 7500000, 2, '2022-08-25', NULL, 'HX00005', 'Nữ'),
('NV00032', 'Lê Thị Hà', 'Bình Dương', '0976543210', 8000000, 2, '2022-09-12', NULL, 'HX00005', 'Nữ');

INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B001', 'Ben xe Mien Dong', 'Thành Phố Hồ Chí Minh');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B002', 'Ben xe Vũng Tàu', 'Thành Phố Vũng Tàu');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B003', 'Ben xe Phía Nam', 'Đồng Nai');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B004', 'Ben xe Gia Lai', 'Gia Lai');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B005', 'Ben xe Nha Trang', 'Khánh Hòa');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B006', 'Ben xe Đà Lạt', 'Lâm Đồng');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B007', 'Ben xe Đà Nẵng', 'Đà Nẵng');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B008', 'Ben xe Cần Thơ', 'Cần Thơ');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B009', 'Ben xe Bạc Liêu', 'Bạc Liêu');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B010', 'Ben xe An Giang', 'An Giang');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B011', 'Ben xe Buôn Ma Thuột', 'Đắk Lắk');
INSERT INTO BENXE (MABEN, TENBEN, DIACHI) VALUES ('B012', 'Ben xe Quy Nhơn', 'Bình Định');

INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT001', 'B001', 'B002');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT002', 'B001', 'B003');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT003', 'B001', 'B004');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT004', 'B001', 'B005');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT005', 'B001', 'B006');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT006', 'B001', 'B007');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT007', 'B001', 'B008');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT008', 'B001', 'B009');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT009', 'B001', 'B010');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT010', 'B001', 'B011');
INSERT INTO TUYENXE (MATUYEN, BENXEDI, BENXEDEN) VALUES ('MT011', 'B001', 'B012');

INSERT INTO LOAIXE(MALOAI, TENLOAI, SOGHE) 
VALUES 
('L001', 'Xe giường nằm', 45),
('L002', 'Xe giường nằm', 40 ),
('L003', 'Xe giường nằm', 34 ),
('L004', 'Xe giường nằm', 22 ),
('L005', 'Xe giường nằm VIP', 45 ),
('L006', 'Xe giường nằm VIP', 40 ),
('L007', 'Xe giường nằm VIP', 34 ),
('L008', 'Xe giường nằm VIP', 30 ),
('L009', 'Xe ghế ngồi', 45 ),
('L010', 'Xe ghế ngồi', 40 ),
('L011', 'Xe ghế ngồi', 36 ),
('L012', 'Xe ghế ngồi', 28 ),
('L013', 'Xe trung chuyển', 28 ),
('L014', 'Xe trung chuyển', 16 ),
('L015', 'Xe trung chuyển', 8 );

INSERT INTO XE (BIENSO, MAHANG, MALOAI)
VALUES
('94B-263.11', 'HX00001', 'L001'),
('53S-2411', 'HX00002', 'L014'),
('72B-034.20', 'HX00005', 'L012'),
('50F-135.79', 'HX00003', 'L013'),
('51B-771.90', 'HX00001', 'L002'),
('47B-357.91', 'HX00002', 'L011'),
('72B-468.02', 'HX00005', 'L004'),
('66B-579.13', 'HX00003', 'L012'),
('51B-680.24', 'HX00001', 'L008'),
('53S-791.35', 'HX00002', 'L009'),
('72B-902.46', 'HX00005', 'L010'),
('50F-013.57', 'HX00003', 'L005'),
('51B-124.68', 'HX00001', 'L006'),
('51B-235.79', 'HX00002', 'L013'),
('50F-346.80', 'HX00005', 'L014'),
('49B-457.91', 'HX00003', 'L015'),
('51B-568.02', 'HX00001', 'L003'),
('47B-027.31', 'HX00004', 'L012'),
('53N-8968', 'HX00004', 'L015'),
('47B-901.35', 'HX00003', 'L007');
INSERT INTO CHUYENXE (MACX, NGAYDI, GIODI, BIENSO, MATUYEN, GIA)
VALUES
  ('CX001', '2023-05-01', '08:00', '94B-263.11', 'MT001', 150000),
  ('CX002', '2023-05-01', '10:30', '53S-2411', NULL, 0),
  ('CX003', '2023-05-01', '13:00', '72B-034.20', 'MT003', 130000),
  ('CX004', '2023-05-02', '09:00', '50F-135.79', NULL, 0),
  ('CX005', '2023-05-02', '12:00', '51B-771.90', 'MT005', 170000),
  ('CX006', '2023-05-02', '15:00', '47B-357.91', 'MT006', 155000),
  ('CX007', '2023-05-03', '10:00', '72B-468.02', 'MT007', 180000),
  ('CX008', '2023-05-03', '13:30', '66B-579.13', 'MT008', 140000),
  ('CX009', '2023-05-03', '16:00', '51B-680.24', 'MT009', 130000),
  ('CX010', '2023-05-04', '08:30', '53S-791.35', 'MT010', 165000),
  ('CX011', '2023-05-04', '11:00', '72B-902.46', 'MT011', 170000),
  ('CX012', '2023-05-04', '14:00', '50F-013.57', 'MT001', 135000),
  ('CX013', '2023-05-05', '09:30', '51B-124.68', 'MT002', 145000),
  ('CX014', '2023-05-05', '12:30', '51B-235.79', NULL, 0),
  ('CX015', '2023-05-05', '15:30', '50F-346.80', NULL, 0),
  ('CX016', '2023-05-06', '10:30', '49B-457.91', NULL, 0),
  ('CX017', '2023-05-06', '13:00', '51B-568.02', 'MT006', 130000),
  ('CX018', '2023-05-06', '16:00', '47B-027.31', 'MT007', 175000),
  ('CX019', '2023-05-07', '08:00', '53N-8968', 'MT008', 195000),
  ('CX020', '2023-05-07', '10:30', '47B-901.35', 'MT009', 155000);


INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD01', 'KH000001', 'NV00003', '2023-05-01', 'Ví MOMO',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD02', 'KH000003', 'NV00004', '2023-05-01', 'Tiền mặt',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD03', 'KH000010', 'NV00018', '2023-05-01', 'Ví MOMO',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD04', 'KH000017', 'NV00006', '2023-05-05', 'Chuyển khoản',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD05', 'KH000020', 'NV00006', '2023-05-03', 'VISA',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD06', 'KH000016', 'NV00004', '2023-05-05', 'CODE',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD07', 'KH000013', 'NV00010', '2023-05-07', 'VISA',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD08', 'KH000019', 'NV00012', '2023-05-06', 'Ví MOMO',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD09', 'KH000007', 'NV00006', '2023-05-04', 'Chuyển khoản',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD10', 'KH000011', 'NV00006', '2023-05-02', 'Tiền mặt',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD11', 'KH000014', 'NV00017', '2023-05-03', 'CODE',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD12', 'KH000004', 'NV00003', '2023-05-02', 'VISA',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD13', 'KH000005', 'NV00012', '2023-05-02', 'Ví MOMO',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD14', 'KH000009', 'NV00010', '2023-05-03', 'Chuyển khoản',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD15', 'KH000018', 'NV00003', '2023-05-07', 'Tiền mặt',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD16', 'KH000006', 'NV00012', '2023-05-06', 'CODE',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD17', 'KH000015', 'NV00015', '2023-05-06', 'Tiền mặt',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD18', 'KH000002', 'NV00018', '2023-05-04', 'Chuyển khoản',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD19', 'KH000008', 'NV00003', '2023-05-04', 'VISA',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD20', 'KH000012', 'NV00003', '2023-05-05', 'CODE',0);
INSERT INTO HOADON (SOHD, MAKH, MANV, NGAYDAT, HT_THANHTOAN, THANHTIEN) VALUES
('HD61', 'KH000012', 'NV00010', '2023-05-05', 'CODE',0);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00123', 'CX001', 'HD01', 0, 1);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00124', 'CX001', 'HD01', 0, 2);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00125', 'CX001', 'HD01', 0, 3);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00126', 'CX001', 'HD01', 0, 4);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00127', 'CX001', 'HD02', 0, 5);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00128', 'CX011', 'HD03', 0, 4);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00129', 'CX006', 'HD04', 0, 2);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00130', 'CX006', 'HD05', 0, 12);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00131', 'CX017', 'HD06', 0, 1);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00132', 'CX017', 'HD06', 0, 2);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00133', 'CX012', 'HD07', 0, 8);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00134', 'CX012', 'HD07', 0, 11);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00135', 'CX020', 'HD08', 0, 3);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00136', 'CX010', 'HD09', 0, 17);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00137', 'CX010', 'HD10', 0, 18);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00138', 'CX011', 'HD11', 0, 2);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00139', 'CX011', 'HD11', 0, 19);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00140', 'CX013', 'HD12', 0, 10);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00141', 'CX013', 'HD12', 0, 15);
INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00142', 'CX012', 'HD13', 0, 11);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00143', 'CX012', 'HD13', 0, 13);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00144', 'CX012', 'HD13', 0, 19);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00145', 'CX012', 'HD13', 0, 22);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00146', 'CX012', 'HD13', 0, 23);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00147', 'CX008', 'HD14', 0, 5);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00148', 'CX008', 'HD14', 0, 7);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00149', 'CX008', 'HD14', 0, 6);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00150', 'CX017', 'HD15', 0, 3);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00151', 'CX017', 'HD15', 0, 4);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00152', 'CX017', 'HD15', 0, 5);

INSERT INTO VE (MAVE, MACX, SOHD, THANHTIEN, VITRI)
VALUES ('VE00153', 'CX017', 'HD15', 0, 6);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00154', 'CX020', 'HD16', 0, 2);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00155', 'CX020', 'HD16', 0, 4);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00156', 'CX020', 'HD16', 0, 5);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00157', 'CX019', 'HD17', 0, 12);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00158', 'CX007', 'HD18', 0, 15);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00159', 'CX013', 'HD19', 0, 24);

INSERT INTO VE (MAVE, MACX, SOHD, GIA, VITRI)
VALUES ('VE00160', 'CX017', 'HD20', 0, 7);

INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00014', 'CX001');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00008', 'CX001');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00002', 'CX002');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00031', 'CX003');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00030', 'CX003');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00026', 'CX004');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00014', 'CX005');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00008', 'CX005');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00023', 'CX006');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00029', 'CX006');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00030', 'CX007');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00032', 'CX007');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00026', 'CX008');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00005', 'CX008');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00009', 'CX009');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00011', 'CX009');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00025', 'CX010');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00029', 'CX010');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00020', 'CX011');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00019', 'CX011');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00027', 'CX012');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00005', 'CX012');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00016', 'CX013');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00013', 'CX013');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00023', 'CX014');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00030', 'CX015');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00001', 'CX016');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00016', 'CX017');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00013', 'CX017');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00021', 'CX018');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00022', 'CX018');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00007', 'CX019');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00027', 'CX020');
INSERT INTO PHANCONG (MANV,  MACX) VALUES ('NV00028', 'CX020');
-- ---------------------------------------------------------------------------------------------------------
-- nhân viên bán vé
-- DROP USER 'NV00004'@'localhost'; DROP USER 'NV00003'@'localhost'; DROP ROLE ROLE_BANVE; drop VIEW VIEW_BANVE02; drop VIEW VIEW_BANVE01;
CREATE USER 'NV00004'@'localhost' IDENTIFIED BY '123456';
CREATE USER 'NV00003'@'localhost' IDENTIFIED BY '123456';
-- View cho tài khoản BANVE01
CREATE  VIEW VIEW_BANVE01 AS
SELECT * FROM NHANVIEN WHERE MANV = 'NV00003';

-- View cho tài khoản BANVE02
CREATE  VIEW VIEW_BANVE02 AS
SELECT * FROM NHANVIEN WHERE MANV = 'NV00004';

CREATE ROLE ROLE_BANVE;
GRANT SELECT, INSERT, UPDATE ON quanlybenxenew.VE TO ROLE_BANVE;
GRANT SELECT, INSERT, UPDATE ON quanlybenxenew.HOADON TO ROLE_BANVE;
GRANT SELECT ON quanlybenxenew.CHUYENXE TO ROLE_BANVE;
GRANT SELECT ON quanlybenxenew.BENXE TO ROLE_BANVE;
GRANT SELECT ON quanlybenxenew.XE TO ROLE_BANVE;
GRANT SELECT, INSERT, UPDATE ON quanlybenxenew.KHACHHANG TO ROLE_BANVE;

GRANT SELECT, UPDATE ON quanlybenxenew.VIEW_BANVE01 TO 'NV00004'@'localhost';
GRANT SELECT, UPDATE ON quanlybenxenew.VIEW_BANVE02 TO 'NV00003'@'localhost';

GRANT ROLE_BANVE TO 'NV00004'@'localhost';
SET DEFAULT ROLE ROLE_BANVE to 'NV00004'@'localhost';
GRANT ROLE_BANVE TO 'NV00003'@'localhost';
SET DEFAULT ROLE ROLE_BANVE to 'NV00003'@'localhost';
-- ---------------------------------------------------------------------------------------------------------

-- Tao 2 user nhan vien phu lai 
CREATE USER 'PHULAI01'@'localhost' IDENTIFIED BY '234567';
CREATE USER 'PHULAI02'@'localhost' IDENTIFIED BY '234567';

CREATE ROLE ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.BENXE TO ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.HANGXE TO ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.LOAIXE TO ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.TUYENXE TO ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.CHUYENXE TO ROLE_PHULAI;
GRANT SELECT ON quanlybenxe.XE TO ROLE_PHULAI;
GRANT SELECT, UPDATE ON quanlybenxe.PHANCONG TO ROLE_PHULAI;

GRANT ROLE_PHULAI TO 'PHULAI01';
SET DEFAULT ROLE ROLE_PHULAI TO 'PHULAI01'@'localhost';
GRANT ROLE_PHULAI TO 'PHULAI02';
SET DEFAULT ROLE ROLE_PHULAI TO 'PHULAI01'@'localhost';
-- ---------------------------------------------------------------------------------------------------------

-- Tao 2 user tai xe
CREATE USER 'TAIXE01'@'localhost' IDENTIFIED BY 'TX01';
CREATE USER 'TAIXE02'@'localhost' IDENTIFIED BY 'TX02';

CREATE ROLE ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.BENXE TO ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.HANGXE TO ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.LOAIXE TO ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.TUYENXE TO ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.XE TO ROLE_TAIXE;
GRANT SELECT ON quanlybenxe.CHUYENXE TO ROLE_TAIXE;
GRANT SELECT, UPDATE ON quanlybenxe.PHANCONG TO ROLE_TAIXE;

GRANT ROLE_TAIXE TO 'TAIXE01'@'localhost';
SET DEFAULT ROLE ROLE_TAIXE TO 'TAIXE01'@'localhost';
GRANT ROLE_TAIXE TO 'TAIXE02'@'localhost';
SET DEFAULT ROLE ROLE_TAIXE TO 'TAIXE02'@'localhost';
-- ---------------------------------------------------------------------------------------------------------

-- Tao 1 user quan ly
CREATE USER 'QUANLY01'@'localhost' IDENTIFIED BY 'QL01';

CREATE ROLE ROLE_QUANLY;

GRANT ALL PRIVILEGES ON quanlybenxe.NHANVIEN TO ROLE_QUANLY;
GRANT ALL PRIVILEGES ON quanlybenxe.XE TO ROLE_QUANLY;
GRANT ALL PRIVILEGES ON quanlybenxe.PHANCONG TO ROLE_QUANLY;
GRANT ALL PRIVILEGES ON quanlybenxe.BENXE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.BANGLAI TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.HANGXE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.LOAIXE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.TUYENXE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.CHUYENXE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.VE TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.HOADON TO ROLE_QUANLY;
GRANT SELECT ON quanlybenxe.CTHD TO ROLE_QUANLY;

GRANT ROLE_QUANLY TO 'QUANLY01'@'localhost';
SET DEFAULT ROLE ROLE_QUANLY TO 'QUANLY01'@'localhost';


